<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Poker Team Financial Simulator</title>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg: #050505;
            --card-bg: rgba(255, 255, 255, 0.03);
            --border: rgba(255, 255, 255, 0.1);
            --accent: #58a6ff;
            --accent-glow: rgba(88, 166, 255, 0.2);
            --success: #238636;
            --text-primary: #f0f6fc;
            --text-secondary: #8b949e;
            --font-main: 'Outfit', sans-serif;
            --font-code: 'JetBrains Mono', monospace;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            background-color: var(--bg);
            color: var(--text-primary);
            font-family: var(--font-main);
            min-height: 100vh;
            padding: 2rem;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h1 {
            font-weight: 700;
            margin-bottom: 0.5rem;
            text-align: center;
        }

        .subtitle {
            color: var(--text-secondary);
            margin-bottom: 2rem;
            text-align: center;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            display: grid;
            grid-template-columns: 3fr 1fr;
            gap: 2rem;
        }

        .card {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.5rem;
            backdrop-filter: blur(10px);
            margin-bottom: 1.5rem;
        }

        .card h2 {
            font-size: 1.2rem;
            margin-bottom: 1rem;
            border-bottom: 1px solid var(--border);
            padding-bottom: 0.5rem;
            color: var(--accent);
        }

        /* Controls */
        .controls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        label {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        input, select {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border);
            color: var(--text-primary);
            padding: 10px;
            border-radius: 6px;
            font-family: var(--font-code);
            font-size: 1rem;
        }

        input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 10px var(--accent-glow);
        }

        /* Table */
        .roster-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        .roster-table th, .roster-table td {
            text-align: left;
            padding: 12px;
            border-bottom: 1px solid var(--border);
            font-size: 0.9rem;
        }

        .roster-table th {
            color: var(--text-secondary);
            font-weight: 600;
        }

        .roster-table tr:hover {
            background: rgba(255,255,255,0.02);
        }

        .action-icon {
            cursor: pointer;
            color: #f85149;
            font-weight: bold;
        }

        .add-btn {
            background: var(--accent);
            color: #fff;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            margin-top: 1rem;
            transition: all 0.2s;
        }
        
        .add-btn:hover {
            filter: brightness(1.2);
        }

        /* Summary Panel */
        .summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
            font-size: 0.95rem;
        }

        .summary-val {
            font-family: var(--font-code);
            font-weight: 700;
        }

        .total-profit {
            color: var(--success);
            font-size: 1.5rem;
        }

        .split-box {
            background: rgba(88, 166, 255, 0.1);
            border: 1px solid var(--accent);
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1rem;
        }

        @media (max-width: 900px) {
            .container { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <h1>Poker Team Financial Simulator</h1>
    <p class="subtitle">Model operational scenarios, tweak variables, and project profitability.</p>

    <div class="container">
        
        <!-- Left Column: Inputs & Roster -->
        <div>
            <!-- Global Settings -->
            <div class="card">
                <h2>Global Parameters</h2>
                <div class="controls-grid">
                    <div class="form-group">
                        <label>Rakeback Deal (%)</label>
                        <input type="number" id="rb-deal" value="70" onchange="recalc()">
                    </div>
                    <div class="form-group">
                        <label>Team Share (%)</label>
                        <input type="number" id="team-share" value="60" onchange="recalc()">
                    </div>
                </div>
            </div>

            <!-- Team Roster -->
            <div class="card">
                <h2>Team Roster</h2>
                <div style="overflow-x: auto;">
                    <table class="roster-table">
                        <thead>
                            <tr>
                                <th>Role</th>
                                <th>Count</th>
                                <th>Stake</th>
                                <th>Vol/Player (Mo)</th>
                                <th>Table WR (bb)</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="roster-body">
                            <!-- Rows injected by JS -->
                        </tbody>
                    </table>
                </div>
                <button class="add-btn" onclick="addRow()">+ Add Player Group</button>
            </div>
        </div>

        <!-- Right Column: Results -->
        <div>
            <div class="card" style="position: sticky; top: 2rem;">
                <h2>Monthly Projections</h2>
                
                <div class="summary-item">
                    <span>Total Volume</span>
                    <span id="total-vol" class="summary-val">0</span>
                </div>
                <div class="summary-item">
                    <span>Net Revenue</span>
                    <span id="total-revenue" class="summary-val">$0</span>
                </div>
                
                <div class="split-box">
                    <div class="summary-item">
                        <span style="color:var(--accent)">TEAM PROFIT</span>
                        <span id="team-profit" class="summary-val total-profit">$0</span>
                    </div>
                    <div class="summary-item">
                        <span>Players Payout</span>
                        <span id="player-profit" class="summary-val">$0</span>
                    </div>
                </div>

                <div style="margin-top: 1.5rem; font-size: 0.8rem; color: var(--text-secondary);">
                    <p>* Calculations based on Est. Rake Paid per Stake.</p>
                    <p>* NL20 Est Rake: 10bb/100</p>
                    <p>* NL60 Est Rake: 8.5bb/100</p>
                    <p>* NL100 Est Rake: 7bb/100</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Constants from TS Script
        const STAKES = {
            'NL20': { name: 'NL20', bbValue: 0.20, estRake: 10.0 },
            'NL60': { name: 'NL60', bbValue: 0.60, estRake: 8.5 },
            'NL100': { name: 'NL100', bbValue: 1.00, estRake: 7.0 },
            'NL200': { name: 'NL200', bbValue: 2.00, estRake: 6.0 }
        };

        // Initial Data
        let roster = [
            { id: 1, role: 'Junior', count: 2, stake: 'NL20', vol: 20000, wr: 1 },
            { id: 2, role: 'Senior', count: 3, stake: 'NL60', vol: 15000, wr: 2 },
            { id: 3, role: 'Captain', count: 2, stake: 'NL100', vol: 12000, wr: 3 }
        ];

        function renderRoster() {
            const tbody = document.getElementById('roster-body');
            tbody.innerHTML = '';

            roster.forEach((group, idx) => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><input type="text" value="${group.role}" onchange="updateRow(${idx}, 'role', this.value)" style="width:100px;"></td>
                    <td><input type="number" value="${group.count}" onchange="updateRow(${idx}, 'count', this.value)" style="width:60px;"></td>
                    <td>
                        <select onchange="updateRow(${idx}, 'stake', this.value)">
                            ${Object.keys(STAKES).map(s => `<option value="${s}" ${s === group.stake ? 'selected' : ''}>${s}</option>`).join('')}
                        </select>
                    </td>
                    <td><input type="number" step="1000" value="${group.vol}" onchange="updateRow(${idx}, 'vol', this.value)"></td>
                    <td><input type="number" step="0.5" value="${group.wr}" onchange="updateRow(${idx}, 'wr', this.value)" style="width:70px;"></td>
                    <td style="text-align:center;"><span class="action-icon" onclick="removeRow(${idx})">âœ•</span></td>
                `;
                tbody.appendChild(tr);
            });
            
            recalc();
        }

        function updateRow(idx, field, value) {
            if (field === 'count' || field === 'vol' || field === 'wr') {
                roster[idx][field] = parseFloat(value);
            } else {
                roster[idx][field] = value;
            }
            recalc();
        }

        function addRow() {
            roster.push({ role: 'New', count: 1, stake: 'NL20', vol: 10000, wr: 0 });
            renderRoster();
        }

        function removeRow(idx) {
            roster.splice(idx, 1);
            renderRoster();
        }

        function recalc() {
            const rbDeal = parseFloat(document.getElementById('rb-deal').value) / 100;
            const teamSharePct = parseFloat(document.getElementById('team-share').value) / 100;
            const playerSharePct = 1 - teamSharePct;

            let totalVol = 0;
            let totalRev = 0;
            
            roster.forEach(group => {
                const stakeCfg = STAKES[group.stake];
                const rakebackBb = stakeCfg.estRake * rbDeal;
                const netWrBb = group.wr + rakebackBb;
                
                const hands = group.vol * group.count;
                const netBb = (netWrBb / 100) * hands;
                const revenue = netBb * stakeCfg.bbValue;

                totalVol += hands;
                totalRev += revenue;
            });

            const teamProfit = totalRev * teamSharePct;
            const playerProfit = totalRev * playerSharePct;

            // Update DOM
            document.getElementById('total-vol').innerText = totalVol.toLocaleString();
            document.getElementById('total-revenue').innerText = '$' + totalRev.toLocaleString(undefined, {minimumFractionDigits: 0, maximumFractionDigits: 0});
            document.getElementById('team-profit').innerText = '$' + teamProfit.toLocaleString(undefined, {minimumFractionDigits: 0, maximumFractionDigits: 0});
            document.getElementById('player-profit').innerText = '$' + playerProfit.toLocaleString(undefined, {minimumFractionDigits: 0, maximumFractionDigits: 0});
        }

        // Init
        renderRoster();

    </script>
</body>
</html>
